<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Image Resizer & Compressor — resize, compress, and download JPG/PNG/WEBP images in the browser. No upload to server." />
  <meta name="keywords" content="image resizer, image compressor, webp, jpg, png, client-side, canvas" />
  <meta name="author" content="GPT-5" />
  <title>Image Resizer & Compressor — Made with GPT-5</title>
  <!-- Favicon (inline SVG) -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='18' fill='%23346ef3'/%3E%3Ctext x='50' y='58' font-size='50' text-anchor='middle' fill='white' font-family='Arial' font-weight='700'%3EI%3C/text%3E%3C/svg%3E">
  <style>
    :root{
      --bg: #f6f8fb;
      --card: #ffffff;
      --muted: #6b7280;
      --accent: linear-gradient(135deg,#7c3aed,#06b6d4);
      --glass: rgba(255,255,255,0.6);
      --success: #10b981;
      --danger: #ef4444;
      --shadow: 0 8px 30px rgba(12,20,40,0.08);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    [data-theme="dark"]{
      --bg: #0b1020;
      --card: #0f1724;
      --muted: #9ca3af;
      --glass: rgba(255,255,255,0.03);
      --shadow: 0 10px 30px rgba(2,6,23,0.7);
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:radial-gradient(1000px 400px at -10% 10%, rgba(52,110,243,0.06), transparent),var(--bg);transition:background .3s}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:32px}
    .container{width:100%;max-width:1100px;background:var(--card);border-radius:16px;padding:22px;box-shadow:var(--shadow);display:grid;grid-template-columns:480px 1fr;gap:20px}

    /* Responsive */
    @media (max-width:960px){
      .container{grid-template-columns:1fr;padding:18px}
    }

    header.app-header{display:flex;align-items:center;gap:14px}
    .logo{display:flex;align-items:center;gap:12px}
    .logo .mark{width:48px;height:48px;border-radius:10px;background:var(--accent);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:20px;box-shadow:0 8px 30px rgba(99,102,241,0.18)}
    h1{margin:0;font-size:20px}
    p.lead{margin:4px 0 0;color:var(--muted);font-size:13px}

    /* Left column: uploader */
    .uploader{display:flex;flex-direction:column;gap:14px}
    .drop{border:2px dashed rgba(52,110,243,0.18);border-radius:12px;padding:22px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;cursor:pointer;transition:transform .15s,box-shadow .15s}
    .drop.dragover{transform:translateY(-4px);box-shadow:0 8px 30px rgba(52,110,243,0.08)}
    .drop input{display:none}
    .drop .hint{color:var(--muted);font-size:14px;text-align:center}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:10px;background:var(--accent);color:#fff;font-weight:600;border:0;cursor:pointer;box-shadow:0 6px 18px rgba(99,102,241,0.18);transition:transform .14s,opacity .14s}
    .btn:active{transform:translateY(2px)}
    .secondary{background:transparent;color:var(--muted);border:1px solid rgba(99,102,241,0.08);box-shadow:none}

    .preview{display:flex;flex-direction:column;gap:10px;padding:12px;border-radius:12px;background:var(--glass);align-items:center}
    .preview img{max-width:100%;max-height:320px;border-radius:10px;object-fit:contain}
    .meta{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .meta .pill{background:rgba(0,0,0,0.04);padding:6px 10px;border-radius:999px;font-size:13px;color:var(--muted)}

    /* Controls */
    .controls{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    label{font-size:13px;color:var(--muted)}
    input[type=number], select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(15,23,42,0.06);background:transparent}
    .full{grid-column:1/-1}
    .slider-wrap{display:flex;align-items:center;gap:12px}
    input[type=range]{width:100%}

    /* Actions */
    .actions{display:flex;gap:10px;margin-top:8px}
    .outline{background:transparent;border:1px solid rgba(99,102,241,0.12);padding:10px 12px;border-radius:10px;color:var(--muted);cursor:pointer}

    footer{display:flex;justify-content:space-between;align-items:center;margin-top:10px;color:var(--muted);font-size:13px}

    /* Right column: results */
    .canvas-card{display:flex;flex-direction:column;gap:12px;padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
    .sizes{display:flex;gap:12px;align-items:center}
    .sizes .box{flex:1;padding:12px;border-radius:10px;background:rgba(0,0,0,0.02);text-align:center}
    .sizes .box strong{display:block;font-size:18px}

    .progress{height:10px;background:rgba(0,0,0,0.06);border-radius:999px;overflow:hidden}
    .progress > i{display:block;height:100%;width:0%;background:linear-gradient(90deg,#7c3aed,#06b6d4);transition:width .35s}

    .result-preview{display:flex;gap:12px;align-items:center}
    .result-preview img{max-width:220px;max-height:180px;border-radius:10px;object-fit:contain;border:1px solid rgba(0,0,0,0.04)}

    .watermark{position:fixed;right:14px;bottom:12px;font-size:12px;color:rgba(100,116,139,0.7);pointer-events:none}
    .made{position:absolute;right:14px;bottom:14px;font-size:10px;color:rgba(255,255,255,0.7);background:rgba(0,0,0,0.18);padding:6px 8px;border-radius:8px}

    /* tiny responsive tweaks */
    @media (max-width:560px){
      .container{padding:12px}
      .logo .mark{width:40px;height:40px}
    }
  </style>
</head>
<body data-theme="light">
  <div class="wrap">
    <div class="container" role="main">
      <div>
        <header class="app-header">
          <div class="logo">
            <div class="mark">I</div>
            <div>
              <h1>Image Resizer & Compressor</h1>
              <p class="lead">Resize and compress images locally — JPG, PNG, WEBP. No uploads.</p>
            </div>
          </div>
          <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
            <label style="display:flex;align-items:center;gap:8px;font-size:13px;color:var(--muted)">
              <input id="themeToggle" type="checkbox" aria-label="Toggle dark mode"> Dark
            </label>
          </div>
        </header>

        <section class="uploader" aria-label="Image uploader">
          <div id="drop" class="drop" tabindex="0">
            <input id="fileInput" type="file" accept="image/jpeg,image/png,image/webp">
            <div style="display:flex;flex-direction:column;align-items:center">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" aria-hidden>
                <path d="M12 3v9" stroke="#3b82f6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="#06b6d4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M7 10l5-5 5 5" stroke="#7c3aed" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <div class="hint">Drag & drop an image here, or <button id="browseBtn" class="btn" type="button">Browse</button></div>
              <div class="hint" style="font-size:12px;margin-top:6px;color:var(--muted)">Supported: JPG / PNG / WEBP — Max 30MB</div>
            </div>
          </div>

          <div class="preview" id="previewArea" style="display:none">
            <img id="previewImg" alt="Uploaded preview">
            <div class="meta" id="metaInfo"></div>
          </div>

          <div style="display:flex;gap:10px;justify-content:space-between;align-items:center">
            <div style="display:flex;gap:8px">
              <button id="resetBtn" class="outline">Reset</button>
              <button id="downloadBtn" class="btn" disabled>Download Image</button>
            </div>
            <div style="font-size:12px;color:var(--muted)">Made with <strong>GPT-5</strong></div>
          </div>
        </section>
      </div>

      <aside class="canvas-card" aria-label="Resize and compression controls">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px">
          <div>
            <strong style="font-size:16px">Output settings</strong>
            <div style="font-size:13px;color:var(--muted)">Choose size & compression</div>
          </div>
          <div style="display:flex;gap:8px">
            <div class="pill" id="origType" style="padding:8px 10px;border-radius:10px;background:rgba(0,0,0,0.04)"></div>
          </div>
        </div>

        <div style="margin-top:6px" class="controls">
          <div>
            <label for="widthInput">Width (px)</label>
            <input id="widthInput" type="number" min="1">
          </div>
          <div>
            <label for="heightInput">Height (px)</label>
            <input id="heightInput" type="number" min="1">
          </div>

          <div style="display:flex;align-items:center;gap:8px">
            <label for="formatSelect">Output format</label>
            <select id="formatSelect">
              <option value="image/jpeg">JPG</option>
              <option value="image/png">PNG</option>
              <option value="image/webp">WEBP</option>
            </select>
          </div>

          <div style="display:flex;align-items:center;gap:8px">
            <label for="aspectLock">Lock aspect</label>
            <input id="aspectLock" type="checkbox" checked>
          </div>

          <div class="full">
            <label for="qualityRange">Quality <span id="qualityVal">90</span>%</label>
            <div class="slider-wrap">
              <input id="qualityRange" type="range" min="10" max="100" value="90">
            </div>
          </div>

          <div class="full">
            <label>Preview & file sizes</label>
            <div class="sizes">
              <div class="box">
                <div style="font-size:12px;color:var(--muted)">Before</div>
                <strong id="beforeSize">—</strong>
                <div id="beforeDim" style="font-size:12px;color:var(--muted)"></div>
              </div>
              <div class="box">
                <div style="font-size:12px;color:var(--muted)">After</div>
                <strong id="afterSize">—</strong>
                <div id="afterDim" style="font-size:12px;color:var(--muted)"></div>
              </div>
            </div>
            <div class="progress" style="margin-top:8px"><i id="progressBar"></i></div>
          </div>
        </div>

        <div style="display:flex;gap:10px;margin-top:6px">
          <button id="applyBtn" class="btn" disabled>Apply</button>
          <button id="previewBtn" class="secondary" disabled>Quick Preview</button>
        </div>

        <div style="margin-top:12px">
          <div class="result-preview" id="resultArea" style="display:none">
            <img id="resultImg" alt="Result preview">
            <div style="flex:1">
              <div style="font-size:13px;color:var(--muted)" id="resultInfo">Export ready</div>
              <div style="display:flex;gap:8px;margin-top:10px">
                <button id="downloadBtn2" class="btn">Download</button>
                <button id="copyBlobBtn" class="outline">Copy to clipboard</button>
              </div>
            </div>
          </div>
        </div>

        <footer>
          <div>Tips: Lock aspect to keep proportions. Use WEBP for smaller files.</div>
          <div id="statusMsg"></div>
        </footer>
      </aside>
    </div>
  </div>

  <div class="watermark">Made with GPT-5</div>

  <script>
    // Elements
    const drop = document.getElementById('drop');
    const fileInput = document.getElementById('fileInput');
    const browseBtn = document.getElementById('browseBtn');
    const previewArea = document.getElementById('previewArea');
    const previewImg = document.getElementById('previewImg');
    const metaInfo = document.getElementById('metaInfo');
    const widthInput = document.getElementById('widthInput');
    const heightInput = document.getElementById('heightInput');
    const qualityRange = document.getElementById('qualityRange');
    const qualityVal = document.getElementById('qualityVal');
    const formatSelect = document.getElementById('formatSelect');
    const aspectLock = document.getElementById('aspectLock');
    const applyBtn = document.getElementById('applyBtn');
    const previewBtn = document.getElementById('previewBtn');
    const beforeSize = document.getElementById('beforeSize');
    const afterSize = document.getElementById('afterSize');
    const beforeDim = document.getElementById('beforeDim');
    const afterDim = document.getElementById('afterDim');
    const progressBar = document.getElementById('progressBar');
    const resultArea = document.getElementById('resultArea');
    const resultImg = document.getElementById('resultImg');
    const resultInfo = document.getElementById('resultInfo');
    const downloadBtn = document.getElementById('downloadBtn');
    const downloadBtn2 = document.getElementById('downloadBtn2');
    const resetBtn = document.getElementById('resetBtn');
    const copyBlobBtn = document.getElementById('copyBlobBtn');
    const statusMsg = document.getElementById('statusMsg');
    const origType = document.getElementById('origType');
    const themeToggle = document.getElementById('themeToggle');

    let currentFile = null;
    let originalImage = new Image();
    let originalBlob = null;
    let outputBlob = null;
    let natural = {w:0,h:0};

    // Helpers
    function humanFileSize(bytes){
      if (!bytes && bytes !== 0) return '—';
      const thresh = 1024;
      if (Math.abs(bytes) < thresh) return bytes + ' B';
      const units = ['KB','MB','GB','TB'];
      let u = -1;
      do { bytes /= thresh; ++u; } while(Math.abs(bytes) >= thresh && u < units.length - 1);
      return bytes.toFixed(2)+' '+units[u];
    }

    function setStatus(msg, danger){
      statusMsg.textContent = msg||'';
      statusMsg.style.color = danger?getComputedStyle(document.documentElement).getPropertyValue('--danger'):'var(--muted)';
    }

    // Drag & drop
    ['dragenter','dragover'].forEach(ev=>{
      drop.addEventListener(ev,e=>{e.preventDefault();e.stopPropagation();drop.classList.add('dragover')});
    });
    ['dragleave','drop'].forEach(ev=>{
      drop.addEventListener(ev,e=>{e.preventDefault();e.stopPropagation();drop.classList.remove('dragover')});
    });

    drop.addEventListener('drop',e=>{
      const dt = e.dataTransfer;
      if (dt && dt.files && dt.files.length) handleFile(dt.files[0]);
    });

    browseBtn.addEventListener('click',()=>fileInput.click());
    fileInput.addEventListener('change',()=>{if(fileInput.files.length) handleFile(fileInput.files[0])});

    function handleFile(file){
      setStatus('');
      if (!file) return;
      if (!/image\/(jpeg|png|webp)/.test(file.type)){
        setStatus('Unsupported file type. Please use JPG, PNG or WEBP.', true);
        return;
      }
      if (file.size > 30 * 1024 * 1024){
        setStatus('File too large. Max is 30MB.', true);
        return;
      }

      currentFile = file;
      origType.textContent = file.type.split('/')[1].toUpperCase();
      beforeSize.textContent = humanFileSize(file.size);
      beforeDim.textContent = '';
      afterSize.textContent = '—';
      afterDim.textContent = '';

      const reader = new FileReader();
      reader.onload = evt=>{
        originalImage = new Image();
        originalImage.onload = ()=>{
          natural.w = originalImage.naturalWidth;
          natural.h = originalImage.naturalHeight;
          previewImg.src = originalImage.src;
          previewArea.style.display = 'flex';
          metaInfo.innerHTML = `<div class="pill">${natural.w}×${natural.h}</div><div class="pill">${file.type.split('/')[1].toUpperCase()}</div>`;
          widthInput.value = natural.w;
          heightInput.value = natural.h;
          beforeDim.textContent = `${natural.w}×${natural.h}`;
          applyBtn.disabled = false;
          previewBtn.disabled = false;
          downloadBtn.disabled = true;
          resultArea.style.display = 'none';
          originalBlob = file;
          // try to set format to the original
          if(file.type === 'image/png') formatSelect.value = 'image/png';
          else if(file.type === 'image/webp') formatSelect.value = 'image/webp';
          else formatSelect.value = 'image/jpeg';
        };
        originalImage.src = evt.target.result;
      };
      reader.readAsDataURL(file);
    }

    // Keep aspect when changing width/height
    widthInput.addEventListener('input',()=>{
      if(!natural.w) return;
      const w = parseInt(widthInput.value) || 1;
      if(aspectLock.checked){
        const h = Math.max(1, Math.round((w / natural.w) * natural.h));
        heightInput.value = h;
      }
    });
    heightInput.addEventListener('input',()=>{
      if(!natural.h) return;
      const h = parseInt(heightInput.value) || 1;
      if(aspectLock.checked){
        const w = Math.max(1, Math.round((h / natural.h) * natural.w));
        widthInput.value = w;
      }
    });

    qualityRange.addEventListener('input',()=>qualityVal.textContent = qualityRange.value);

    // Core: convert using canvas
    async function convertImage(){
      if(!originalImage.src) return null;
      const outType = formatSelect.value;
      const w = Math.max(1, parseInt(widthInput.value) || 1);
      const h = Math.max(1, parseInt(heightInput.value) || 1);
      const quality = Math.max(0.1, Math.min(1, qualityRange.value/100));

      // Offscreen canvas
      const canvas = document.createElement('canvas');
      canvas.width = w;
      canvas.height = h;
      const ctx = canvas.getContext('2d');

      // Smooth scaling
      ctx.imageSmoothingEnabled = true;
      ctx.imageSmoothingQuality = 'high';

      // draw
      ctx.clearRect(0,0,w,h);
      ctx.drawImage(originalImage, 0, 0, w, h);

      // progress animation (fake but smooth)
      progressBar.style.width = '8%';
      await new Promise(r=>setTimeout(r,60));
      progressBar.style.width = '30%';

      // toBlob
      const blob = await new Promise(resolve=>{
        // For PNG the quality parameter is ignored by many browsers, but still pass it when not JPEG
        canvas.toBlob(b=>resolve(b), outType, outType === 'image/png'?undefined:quality);
      });

      progressBar.style.width = '100%';
      await new Promise(r=>setTimeout(r,140));
      progressBar.style.width = '0%';

      return {blob, w, h, type: outType};
    }

    applyBtn.addEventListener('click', async ()=>{
      setStatus('Processing...');
      applyBtn.disabled = true;
      previewBtn.disabled = true;
      try{
        const res = await convertImage();
        if(!res || !res.blob) throw new Error('Failed to process image.');
        outputBlob = res.blob;
        afterSize.textContent = humanFileSize(outputBlob.size);
        afterDim.textContent = `${res.w}×${res.h}`;
        resultImg.src = URL.createObjectURL(outputBlob);
        resultArea.style.display = 'flex';
        downloadBtn.disabled = false;
        downloadBtn2.disabled = false;
        downloadBtn.href = URL.createObjectURL(outputBlob);
        downloadBtn.download = 'image.' + (res.type.split('/')[1]||'jpg');
        downloadBtn2.onclick = ()=>downloadFile(outputBlob, 'image.' + (res.type.split('/')[1]||'jpg'));
        resultInfo.textContent = `Type: ${res.type.split('/')[1].toUpperCase()} • ${humanFileSize(outputBlob.size)}`;
        setStatus('Done');
      }catch(err){
        console.error(err);
        setStatus(err.message||'Error processing image', true);
      }finally{
        applyBtn.disabled = false;
        previewBtn.disabled = false;
      }
    });

    previewBtn.addEventListener('click', async ()=>{
      previewBtn.disabled = true;
      setStatus('Quick preview...');
      try{
        const res = await convertImage();
        if(!res || !res.blob) throw new Error('Preview failed');
        resultImg.src = URL.createObjectURL(res.blob);
        resultArea.style.display = 'flex';
        afterSize.textContent = humanFileSize(res.blob.size);
        afterDim.textContent = `${res.w}×${res.h}`;
        resultInfo.textContent = `Preview • ${humanFileSize(res.blob.size)}`;
        outputBlob = res.blob; // keep preview as available blob
        downloadBtn.disabled = false;
        downloadBtn.href = URL.createObjectURL(outputBlob);
        downloadBtn.download = 'preview.' + (res.type.split('/')[1]||'jpg');
      }catch(err){
        setStatus('Preview error', true);
      }finally{previewBtn.disabled = false}
    });

    function downloadFile(blob, filename){
      const a = document.createElement('a');
      const url = URL.createObjectURL(blob);
      a.href = url; a.download = filename; document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 5000);
    }

    downloadBtn.addEventListener('click', ()=>{
      if(outputBlob) downloadFile(outputBlob, downloadBtn.download||'image.jpg');
    });
    downloadBtn2.addEventListener('click', ()=>{
      if(outputBlob) downloadFile(outputBlob, downloadBtn2.getAttribute('data-fn')||'image.jpg');
    });

    resetBtn.addEventListener('click', ()=>{
      currentFile = null; originalBlob = null; outputBlob = null; originalImage = new Image(); natural={w:0,h:0};
      previewArea.style.display='none'; resultArea.style.display='none'; applyBtn.disabled=true; previewBtn.disabled=true; downloadBtn.disabled=true; downloadBtn.href='';
      beforeSize.textContent = '—'; afterSize.textContent='—'; beforeDim.textContent=''; afterDim.textContent=''; setStatus('');
    });

    // Copy blob to clipboard
    copyBlobBtn.addEventListener('click', async ()=>{
      if(!outputBlob){ setStatus('No image to copy', true); return; }
      try{
        // ClipboardImage support
        const item = new ClipboardItem({[outputBlob.type]: outputBlob});
        await navigator.clipboard.write([item]);
        setStatus('Image copied to clipboard');
      }catch(err){
        console.error(err);
        setStatus('Copy failed. Your browser may not support clipboard images.', true);
      }
    });

    // Theme toggle
    themeToggle.addEventListener('change', (e)=>{
      document.body.setAttribute('data-theme', e.target.checked? 'dark':'light');
    });

    // keyboard accessibility: Enter opens file dialog
    drop.addEventListener('keydown', e=>{ if(e.key==='Enter' || e.key===' ') fileInput.click() });

    // show initial tiny hint
    setStatus('Choose an image to get started');
  </script>
</body>
</html>
